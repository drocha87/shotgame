{"version":3,"file":"main.js","sourceRoot":"","sources":["../src/main.ts"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,EAAE,SAAS,EAAE,gBAAgB,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,WAAW,CAAC;AAE5E,MAAM,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAsB,CAAC;AACtE,MAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAEpC,SAAS,YAAY,CAAC,GAA6B;IACjD,MAAM,MAAM,GAAG,EAAE,GAAG,CAAC,CAAC;IAEtB,IAAI,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC;IAC9B,IAAI,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC;IAEhC,8BAA8B;IAC9B,IAAI,KAAK,GAAG,MAAM,GAAG,MAAM,EAAE,CAAC;QAC5B,KAAK,GAAG,MAAM,GAAG,MAAM,CAAC;IAC1B,CAAC;SAAM,CAAC;QACN,MAAM,GAAG,KAAK,GAAG,MAAM,CAAC;IAC1B,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC;IAClC,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC;IACpC,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;IACxB,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;IAE1B,+CAA+C;IAC/C,MAAM,GAAG,GAAG,MAAM,CAAC,gBAAgB,IAAI,CAAC,CAAC;IACzC,MAAM,CAAC,KAAK,GAAG,KAAK,GAAG,GAAG,CAAC;IAC3B,MAAM,CAAC,MAAM,GAAG,MAAM,GAAG,GAAG,CAAC;IAE7B,GAAG,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,oBAAoB;IACxD,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,4BAA4B;AACnD,CAAC;AAED,SAAS,cAAc,CAAC,GAA6B;IACnD,GAAG,CAAC,SAAS,GAAG,SAAS,CAAC;IAC1B,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;IAEhD,MAAM,WAAW,GAAG,WAAW,CAAC;IAEhC,GAAG,CAAC,SAAS,GAAG,OAAO,CAAC;IACxB,GAAG,CAAC,IAAI,GAAG,iBAAiB,CAAC;IAC7B,MAAM,OAAO,GAAG,GAAG,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;IAE7C,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC3C,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;IACjC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAEhC,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,SAAS,CAAC,KAAK,CAAC;IAClD,IAAI,QAAQ,GAAG,CAAC,CAAC;IACjB,IAAI,IAAI,GAAG,OAAO,GAAG,CAAC,EAAE,CAAC;QACvB,QAAQ,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,GAAG,OAAO,CAAC,CAAC;IAC1D,CAAC;IAED,CAAC,IAAI,EAAE,CAAC;IACR,CAAC,IAAI,EAAE,CAAC;IACR,GAAG,CAAC,IAAI,GAAG,iBAAiB,CAAC;IAC7B,GAAG,CAAC,QAAQ,CAAC,gBAAgB,IAAI,GAAG,OAAO,GAAG,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAE9D,CAAC,IAAI,EAAE,CAAC;IACR,GAAG,CAAC,QAAQ,CAAC,aAAa,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAE/D,CAAC,IAAI,EAAE,CAAC;IACR,GAAG,CAAC,QAAQ,CAAC,UAAU,SAAS,CAAC,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAClD,CAAC;AAED,SAAS,mBAAmB,CAAC,KAAiB;IAC5C,SAAS,CAAC,aAAa,CAAC,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC;IAC7C,SAAS,CAAC,aAAa,CAAC,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC;AAC/C,CAAC;AAED,SAAS,aAAa,CAAC,KAAoB;IACzC,gCAAgC;IAChC,kBAAkB;IAClB,IAAI;AACN,CAAC;AAED,0BAA0B;AAC1B,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,GAAG,EAAE;IACrC,YAAY,CAAC,GAAI,CAAC,CAAC;AACrB,CAAC,CAAC,CAAC;AAEH,YAAY,CAAC,GAAI,CAAC,CAAC;AAEnB,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAS,EAAE;IAC1C,IAAI,CAAC,QAAQ,CAAC,kBAAkB,EAAE,CAAC;QACjC,MAAM,MAAM,CAAC,kBAAkB,CAAC;YAC9B,kBAAkB,EAAE,IAAI;SACzB,CAAC,CAAC;IACL,CAAC;AACH,CAAC,CAAA,CAAC,CAAC;AAEH,QAAQ,CAAC,gBAAgB,CAAC,mBAAmB,EAAE,GAAG,EAAE;IAClD,IAAI,QAAQ,CAAC,kBAAkB,KAAK,MAAM,EAAE,CAAC;QAC3C,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,mBAAmB,CAAC,CAAC;QAC5D,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;QACzD,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;QAEpD,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;IAC3B,CAAC;SAAM,CAAC;QACN,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,mBAAmB,CAAC,CAAC;QAC/D,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;QAC5D,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;QAEvD,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;IAC1B,CAAC;AACH,CAAC,CAAC,CAAC;AAEH,IAAI,iBAAiB,GAAwB,CAAC,CAAC;AAE/C,SAAS,QAAQ,CAAC,SAA8B;IAC9C,MAAM,KAAK,GAAG,CAAC,SAAS,GAAG,iBAAiB,CAAC,GAAG,IAAI,CAAC;IACrD,iBAAiB,GAAG,SAAS,CAAC;IAE9B,IAAI,SAAS,CAAC,cAAc,IAAI,CAAC,EAAE,CAAC;QAClC,cAAc,CAAC,GAAI,CAAC,CAAC;QACrB,OAAO;IACT,CAAC;IAED,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;QACtB,SAAS,CAAC,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QAC/D,SAAS,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QAE3D,IAAI,SAAS,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,SAAS,CAAC,cAAc,GAAG,CAAC,EAAE,CAAC;YACjE,UAAU,EAAE,CAAC;YACb,SAAS,CAAC,cAAc,GAAG,CAAC,CAAC;QAC/B,CAAC;aAAM,CAAC;YACN,SAAS,CAAC,cAAc,IAAI,KAAK,CAAC;QACpC,CAAC;QAED,MAAM,CAAC,GAAI,EAAE,KAAK,CAAC,CAAC;IACtB,CAAC;IAED,qBAAqB,CAAC,QAAQ,CAAC,CAAC;AAClC,CAAC;AAED,sEAAsE;AACtE,qBAAqB,CAAC,CAAC,SAAS,EAAE,EAAE;IAClC,iBAAiB,GAAG,SAAS,CAAC;IAC9B,qBAAqB,CAAC,QAAQ,CAAC,CAAC;AAClC,CAAC,CAAC,CAAC","sourcesContent":["import { gameState, handleMouseClick, render, spawTarget } from \"./game.js\";\n\nconst canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\nconst ctx = canvas.getContext(\"2d\");\n\nfunction resizeCanvas(ctx: CanvasRenderingContext2D) {\n  const aspect = 16 / 9;\n\n  let width = window.innerWidth;\n  let height = window.innerHeight;\n\n  // Adjust height to keep ratio\n  if (width / height > aspect) {\n    width = height * aspect;\n  } else {\n    height = width / aspect;\n  }\n\n  canvas.style.width = width + \"px\";\n  canvas.style.height = height + \"px\";\n  gameState.width = width;\n  gameState.height = height;\n\n  // Set actual drawing buffer (high DPI support)\n  const dpr = window.devicePixelRatio || 1;\n  canvas.width = width * dpr;\n  canvas.height = height * dpr;\n\n  ctx.setTransform(1, 0, 0, 1, 0, 0); // reset any scaling\n  ctx.scale(dpr, dpr); // ensure drawings are sharp\n}\n\nfunction renderGameOver(ctx: CanvasRenderingContext2D) {\n  ctx.fillStyle = \"#fafafa\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  const gameOverStr = \"GAME OVER\";\n\n  ctx.fillStyle = \"black\";\n  ctx.font = \"24px sans-serif\";\n  const metrics = ctx.measureText(gameOverStr);\n\n  let x = (canvas.width - metrics.width) / 2;\n  let y = (canvas.height - 24) / 2;\n  ctx.fillText(gameOverStr, x, y);\n\n  const { good, missed, perfect } = gameState.shots;\n  let accuracy = 0;\n  if (good + perfect > 0) {\n    accuracy = (good + perfect) / (missed + good + perfect);\n  }\n\n  x += 25;\n  y += 35;\n  ctx.font = \"14px sans-serif\";\n  ctx.fillText(`Total Shots: ${good + perfect + missed}`, x, y);\n\n  y += 25;\n  ctx.fillText(`Accuracy: ${Math.floor(accuracy * 100)}%`, x, y);\n\n  y += 25;\n  ctx.fillText(`Level: ${gameState.level}`, x, y);\n}\n\nfunction handleMouseMovement(event: MouseEvent) {\n  gameState.mousePosition.x += event.movementX;\n  gameState.mousePosition.y += event.movementY;\n}\n\nfunction handleKeyDown(event: KeyboardEvent) {\n  // if (event.code === \"Space\") {\n  //   spawTarget();\n  // }\n}\n\n// Call once and on resize\nwindow.addEventListener(\"resize\", () => {\n  resizeCanvas(ctx!);\n});\n\nresizeCanvas(ctx!);\n\ncanvas.addEventListener(\"click\", async () => {\n  if (!document.pointerLockElement) {\n    await canvas.requestPointerLock({\n      unadjustedMovement: true,\n    });\n  }\n});\n\ndocument.addEventListener(\"pointerlockchange\", () => {\n  if (document.pointerLockElement === canvas) {\n    document.addEventListener(\"mousemove\", handleMouseMovement);\n    document.addEventListener(\"mousedown\", handleMouseClick);\n    document.addEventListener(\"keydown\", handleKeyDown);\n\n    gameState.paused = false;\n  } else {\n    document.removeEventListener(\"mousemove\", handleMouseMovement);\n    document.removeEventListener(\"mousedown\", handleMouseClick);\n    document.removeEventListener(\"keydown\", handleKeyDown);\n\n    gameState.paused = true;\n  }\n});\n\nlet previousTimestamp: DOMHighResTimeStamp = 0;\n\nfunction gameLoop(timestamp: DOMHighResTimeStamp) {\n  const delta = (timestamp - previousTimestamp) / 1000;\n  previousTimestamp = timestamp;\n\n  if (gameState.availableShots <= 0) {\n    renderGameOver(ctx!);\n    return;\n  }\n\n  if (!gameState.paused) {\n    gameState.targets = gameState.targets.filter((x) => !x.remove);\n    gameState.texts = gameState.texts.filter((x) => !x.remove);\n\n    if (gameState.targets.length < 3 && gameState.lastSpawedDisc > 1) {\n      spawTarget();\n      gameState.lastSpawedDisc = 0;\n    } else {\n      gameState.lastSpawedDisc += delta;\n    }\n\n    render(ctx!, delta);\n  }\n\n  requestAnimationFrame(gameLoop);\n}\n\n// skip the first frame so we can save the previousTimestamp correctly\nrequestAnimationFrame((timestamp) => {\n  previousTimestamp = timestamp;\n  requestAnimationFrame(gameLoop);\n});\n"]}