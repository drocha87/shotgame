{"version":3,"file":"main.js","sourceRoot":"","sources":["../src/main.ts"],"names":[],"mappings":"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","sourcesContent":["const canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\nconst ctx = canvas.getContext(\"2d\");\n\nconst shotSound = new Audio(\"lmg_fire01.flac\");\nconst loseSound = new Audio(\"lose sound 2 - 2.flac\");\n\ntype Disc = {\n  x: number;\n  y: number;\n  radius: number;\n  velocity: number;\n  remove: boolean;\n  duration: number; // stay alive in seconds\n};\n\ntype Aim = {\n  x: number;\n  y: number;\n  radius: number;\n};\n\nenum ShotAccuracy {\n  Missed,\n  Touch,\n  Perfect,\n}\n\ntype TText = {\n  text: string;\n  x: number;\n  y: number;\n  font: string;\n  color: string;\n};\n\nconst gameState = {\n  ctx: ctx!,\n  mousePosition: { x: 0, y: 0 },\n  discs: [] as Array<Disc>,\n  paused: true,\n  gameOver: false,\n  availableShots: 10,\n  shots: {\n    missed: 0,\n    good: 0,\n    perfect: 0,\n  },\n  lastSpawedDisc: 0,\n  accuracy: 0,\n  texts: [] as Array<{ text: TText; duration: number; remove: boolean }>,\n};\n\ntype GameState = typeof gameState;\n\nfunction shot(a: Aim, b: Disc, tolerance: number = 1): ShotAccuracy {\n  const dx = b.x - a.x;\n  const dy = b.y - a.y;\n  const distanceSquared = dx * dx + dy * dy;\n  const radiusSum = a.radius + b.radius + tolerance;\n  const radiusSumSquared = radiusSum * radiusSum;\n  const radiusDiff = Math.abs(a.radius - b.radius) - tolerance;\n  const radiusDiffSquared = radiusDiff * radiusDiff;\n\n  if (distanceSquared > radiusSumSquared) {\n    return ShotAccuracy.Missed;\n  }\n\n  if (\n    distanceSquared >= radiusDiffSquared &&\n    distanceSquared <= radiusSumSquared\n  ) {\n    return ShotAccuracy.Touch;\n  }\n\n  return ShotAccuracy.Perfect;\n}\n\nfunction resizeCanvas(ctx: CanvasRenderingContext2D) {\n  const aspect = 16 / 9;\n\n  let width = window.innerWidth;\n  let height = window.innerHeight;\n\n  // Adjust height to keep ratio\n  if (width / height > aspect) {\n    width = height * aspect;\n  } else {\n    height = width / aspect;\n  }\n\n  canvas.style.width = width + \"px\";\n  canvas.style.height = height + \"px\";\n\n  // Set actual drawing buffer (high DPI support)\n  const dpr = window.devicePixelRatio || 1;\n  canvas.width = width * dpr;\n  canvas.height = height * dpr;\n\n  ctx.setTransform(1, 0, 0, 1, 0, 0); // reset any scaling\n  ctx.scale(dpr, dpr); // ensure drawings are sharp\n}\n\nfunction renderCircle(\n  ctx: CanvasRenderingContext2D,\n  position: { x: number; y: number },\n  radius: number,\n  color: string\n) {\n  ctx.fillStyle = color;\n  ctx.beginPath();\n  ctx.arc(position.x, position.y, radius, 0, 2 * Math.PI, true);\n  ctx.fill();\n}\n\nfunction renderCursor(ctx: CanvasRenderingContext2D) {\n  renderCircle(ctx, gameState.mousePosition, 3, \"#181818\");\n}\n\nfunction renderDiscs(state: GameState, delta: number) {\n  for (const disc of state.discs) {\n    renderCircle(state.ctx, { x: disc.x, y: disc.y }, disc.radius, \"#fe9a00\");\n    disc.duration -= delta;\n    if (disc.duration < 0) {\n      gameState.availableShots -= 1;\n      disc.remove = true;\n\n      gameState.texts.push({\n        text: {\n          text: \"You missed!\",\n          x: disc.x - 20,\n          y: disc.y + 20,\n          font: \"14px sans-serif\",\n          color: \"red\",\n        },\n        duration: 0.5,\n        remove: false,\n      });\n      loseSound.currentTime = 0;\n      loseSound.play();\n    }\n  }\n}\n\nfunction renderText(ctx: CanvasRenderingContext2D, text: TText) {\n  ctx.fillStyle = text.color;\n  ctx.font = text.font;\n  ctx.fillText(text.text, text.x, text.y);\n}\n\nfunction renderStats(ctx: CanvasRenderingContext2D) {\n  renderText(ctx, {\n    text: `Available Shots: ${gameState.availableShots}`,\n    x: 20,\n    y: 30,\n    font: \"18px sans-serif\",\n    color: \"black\",\n  });\n\n  const { good, missed, perfect } = gameState.shots;\n  const accuracy = (good + perfect) / (missed + good + perfect);\n\n  renderText(ctx, {\n    text: `Total Shots: ${good + perfect + missed}`,\n    x: 20,\n    y: 60,\n    font: \"18px sans-serif\",\n    color: \"black\",\n  });\n\n  renderText(ctx, {\n    text: `Accuracy: ${Math.floor(accuracy * 100)}%`,\n    x: 20,\n    y: canvas.height - 20,\n    font: \"18px sans-serif\",\n    color: \"black\",\n  });\n}\n\nfunction render(ctx: CanvasRenderingContext2D, delta: number) {\n  ctx.fillStyle = \"#fafafa\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  renderStats(ctx);\n  renderDiscs(gameState, delta);\n\n  for (const text of gameState.texts) {\n    if (text.duration <= 0) {\n      text.remove = true;\n      continue;\n    }\n\n    renderText(ctx, text.text);\n    text.duration -= delta;\n  }\n\n  renderCursor(ctx);\n}\n\nfunction renderGameOver(ctx: CanvasRenderingContext2D) {\n  ctx.fillStyle = \"#fafafa\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n  const gameOverStr = `GAME OVER`;\n\n  ctx.fillStyle = \"black\";\n  ctx.font = \"24px sans-serif\";\n  const metrics = ctx.measureText(gameOverStr);\n\n  ctx.fillText(\n    gameOverStr,\n    (canvas.width - metrics.width) / 2,\n    (canvas.height - 24) / 2\n  );\n}\n\n// Call once and on resize\nwindow.addEventListener(\"resize\", () => {\n  resizeCanvas(ctx!);\n});\n\nresizeCanvas(ctx!);\n\nfunction handleMouseMovement(event: MouseEvent) {\n  gameState.mousePosition.x += event.movementX;\n  gameState.mousePosition.y += event.movementY;\n}\n\nfunction handleMouseClick(_event: MouseEvent) {\n  let accuracy = ShotAccuracy.Missed;\n\n  shotSound.currentTime = 0;\n  shotSound.play();\n\n  const aim = {\n    x: gameState.mousePosition.x,\n    y: gameState.mousePosition.y,\n    radius: 2,\n  };\n\n  for (const disc of gameState.discs) {\n    accuracy = shot(aim, disc);\n    if (accuracy === ShotAccuracy.Touch || accuracy === ShotAccuracy.Perfect) {\n      disc.remove = true;\n      break;\n    }\n  }\n\n  switch (accuracy) {\n    case ShotAccuracy.Missed:\n      {\n        gameState.availableShots -= 1;\n        gameState.shots.missed += 1;\n\n        gameState.texts.push({\n          text: {\n            text: \"You missed!\",\n            x: aim.x - 20,\n            y: aim.y + 20,\n            font: \"14px sans-serif\",\n            color: \"black\",\n          },\n          duration: 0.5,\n          remove: false,\n        });\n      }\n      break;\n\n    case ShotAccuracy.Touch:\n      {\n        gameState.shots.good += 1;\n        gameState.texts.push({\n          text: {\n            text: \"Good shot!\",\n            x: aim.x - 20,\n            y: aim.y + 20,\n            font: \"14px sans-serif\",\n            color: \"black\",\n          },\n          duration: 0.5,\n          remove: false,\n        });\n      }\n      break;\n\n    case ShotAccuracy.Perfect:\n      {\n        gameState.shots.perfect += 1;\n        gameState.availableShots += 1;\n\n        gameState.texts.push({\n          text: {\n            text: \"Perfect shot!\",\n            x: aim.x - 20,\n            y: aim.y + 20,\n            font: \"14px sans-serif\",\n            color: \"black\",\n          },\n          duration: 0.5,\n          remove: false,\n        });\n      }\n      break;\n  }\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction spawDisc() {\n  const rand = Math.random();\n\n  const padding = 100;\n  const radius = clamp(20 * rand, 5, 20);\n  const x = clamp(\n    canvas.width * rand,\n    radius + padding,\n    canvas.width - radius - padding\n  );\n  const y = clamp(\n    canvas.height * rand,\n    radius + padding,\n    canvas.height - radius - padding\n  );\n\n  gameState.discs.push({\n    x,\n    y,\n    radius,\n    velocity: 200 * rand,\n    remove: false,\n    duration: 2,\n  });\n}\n\nfunction handleKeyDown(event: KeyboardEvent) {\n  if (event.code === \"Space\") {\n    spawDisc();\n  }\n}\n\ncanvas.addEventListener(\"click\", async () => {\n  if (!document.pointerLockElement) {\n    await canvas.requestPointerLock({\n      unadjustedMovement: true,\n    });\n  }\n});\n\ndocument.addEventListener(\"pointerlockchange\", () => {\n  if (document.pointerLockElement === canvas) {\n    document.addEventListener(\"mousemove\", handleMouseMovement);\n    document.addEventListener(\"mousedown\", handleMouseClick);\n    document.addEventListener(\"keydown\", handleKeyDown);\n\n    gameState.paused = false;\n  } else {\n    document.removeEventListener(\"mousemove\", handleMouseMovement);\n    document.removeEventListener(\"mousedown\", handleMouseClick);\n    document.removeEventListener(\"keydown\", handleKeyDown);\n\n    gameState.paused = true;\n  }\n});\n\nlet previousTimestamp: DOMHighResTimeStamp = 0;\n\nfunction gameLoop(timestamp: DOMHighResTimeStamp) {\n  const delta = (timestamp - previousTimestamp) / 1000;\n  previousTimestamp = timestamp;\n\n  if (gameState.gameOver) {\n    renderGameOver(ctx!);\n    return;\n  }\n\n  if (!gameState.paused) {\n    gameState.discs = gameState.discs.filter((x) => !x.remove);\n    gameState.texts = gameState.texts.filter((x) => !x.remove);\n\n    if (gameState.discs.length < 3 && gameState.lastSpawedDisc > 1) {\n      spawDisc();\n      gameState.lastSpawedDisc = 0;\n    } else {\n      gameState.lastSpawedDisc += delta;\n    }\n\n    render(ctx!, delta);\n  }\n\n  requestAnimationFrame(gameLoop);\n}\n\n// skip the first frame so we can save the previousTimestamp correctly\nrequestAnimationFrame((timestamp) => {\n  previousTimestamp = timestamp;\n  requestAnimationFrame(gameLoop);\n});\n"]}